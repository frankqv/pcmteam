# ========================================
# BLOQUEO DE PAÍSES SANCIONADOS POR EE.UU.
# ========================================

# Permitir acceso local y servidores
SetEnvIf Remote_Addr ^127\.0\.0\.1$ AllowLocal
SetEnvIf Remote_Addr ^::1$ AllowLocal
SetEnvIf Remote_Addr ^192\. AllowPrivate
SetEnvIf Remote_Addr ^10\. AllowPrivate
SetEnvIf Remote_Addr ^172\.(1[6-9]|2[0-9]|3[0-1])\. AllowPrivate

# ========================================
# BLOQUEAR PAÍSES SANCIONADOS
# ========================================

# RUSIA - Rangos principales
SetEnvIf Remote_Addr ^5\.34\. BlockedCountry
SetEnvIf Remote_Addr ^5\.35\. BlockedCountry
SetEnvIf Remote_Addr ^37\.14[0-3]\. BlockedCountry
SetEnvIf Remote_Addr ^46\.17[2-5]\. BlockedCountry
SetEnvIf Remote_Addr ^46\.19[2-5]\. BlockedCountry
SetEnvIf Remote_Addr ^77\.88\. BlockedCountry
SetEnvIf Remote_Addr ^78\.10[8-9]\. BlockedCountry
SetEnvIf Remote_Addr ^85\.14[2-3]\. BlockedCountry
SetEnvIf Remote_Addr ^91\.20[0-7]\. BlockedCountry
SetEnvIf Remote_Addr ^91\.21[6-9]\. BlockedCountry
SetEnvIf Remote_Addr ^95\.16[8-9]\. BlockedCountry
SetEnvIf Remote_Addr ^95\.17[0-5]\. BlockedCountry
SetEnvIf Remote_Addr ^178\.15[4-9]\. BlockedCountry
SetEnvIf Remote_Addr ^185\.4[0-7]\. BlockedCountry
SetEnvIf Remote_Addr ^188\.16[2-7]\. BlockedCountry
SetEnvIf Remote_Addr ^212\.19[2-3]\. BlockedCountry

# IRAN - Rangos principales
SetEnvIf Remote_Addr ^2\.17[6-9]\. BlockedCountry
SetEnvIf Remote_Addr ^5\.9[4-9]\. BlockedCountry
SetEnvIf Remote_Addr ^31\.56\. BlockedCountry
SetEnvIf Remote_Addr ^37\.156\. BlockedCountry
SetEnvIf Remote_Addr ^37\.191\. BlockedCountry
SetEnvIf Remote_Addr ^46\.224\. BlockedCountry
SetEnvIf Remote_Addr ^78\.15[6-9]\. BlockedCountry
SetEnvIf Remote_Addr ^85\.18[5-6]\. BlockedCountry
SetEnvIf Remote_Addr ^91\.10[6-9]\. BlockedCountry
SetEnvIf Remote_Addr ^94\.182\. BlockedCountry
SetEnvIf Remote_Addr ^176\.102\. BlockedCountry
SetEnvIf Remote_Addr ^185\.4[4-7]\. BlockedCountry

# COREA DEL NORTE
SetEnvIf Remote_Addr ^175\.45\. BlockedCountry
SetEnvIf Remote_Addr ^210\.52\. BlockedCountry

# SIRIA
SetEnvIf Remote_Addr ^5\.0\. BlockedCountry
SetEnvIf Remote_Addr ^82\.137\. BlockedCountry
SetEnvIf Remote_Addr ^185\.166\. BlockedCountry

# CUBA
SetEnvIf Remote_Addr ^152\.206\. BlockedCountry
SetEnvIf Remote_Addr ^169\.158\. BlockedCountry
SetEnvIf Remote_Addr ^200\.0\. BlockedCountry
SetEnvIf Remote_Addr ^200\.1[4-5]\. BlockedCountry

# ========================================
# PERMITIR PAÍSES ESPECÍFICOS
# ========================================

# COLOMBIA - Rangos más completos
# Movistar Colombia
SetEnvIf Remote_Addr ^181\.(4[8-9]|5[0-9]|6[0-3])\. AllowCountry
SetEnvIf Remote_Addr ^200\.6[8-9]\. AllowCountry
SetEnvIf Remote_Addr ^200\.7[0-5]\. AllowCountry

# Claro Colombia
SetEnvIf Remote_Addr ^186\.(8[0-9]|9[0-5])\. AllowCountry
SetEnvIf Remote_Addr ^201\.23[2-9]\. AllowCountry
SetEnvIf Remote_Addr ^201\.24[0-7]\. AllowCountry

# ETB / Tigo / Otros proveedores
SetEnvIf Remote_Addr ^179\.(0[0-9]|1[0-5])\. AllowCountry
SetEnvIf Remote_Addr ^190\.14[0-5]\. AllowCountry
SetEnvIf Remote_Addr ^190\.24[8-9]\. AllowCountry
SetEnvIf Remote_Addr ^190\.25[0-5]\. AllowCountry
SetEnvIf Remote_Addr ^200\.21[2-9]\. AllowCountry
SetEnvIf Remote_Addr ^200\.22[0-7]\. AllowCountry

# BRASIL - Rangos principales
# Claro/NET Brasil
SetEnvIf Remote_Addr ^177\. AllowCountry
SetEnvIf Remote_Addr ^187\. AllowCountry
SetEnvIf Remote_Addr ^189\. AllowCountry

# Vivo Brasil
SetEnvIf Remote_Addr ^179\. AllowCountry
SetEnvIf Remote_Addr ^191\. AllowCountry

# Oi Brasil
SetEnvIf Remote_Addr ^138\. AllowCountry
SetEnvIf Remote_Addr ^186\. AllowCountry

# Tim Brasil
SetEnvIf Remote_Addr ^170\. AllowCountry
SetEnvIf Remote_Addr ^152\. AllowCountry

# ESTADOS UNIDOS - Permitir (opcional)
SetEnvIf Remote_Addr ^23\. AllowCountry
SetEnvIf Remote_Addr ^24\. AllowCountry
SetEnvIf Remote_Addr ^50\. AllowCountry
SetEnvIf Remote_Addr ^63\. AllowCountry
SetEnvIf Remote_Addr ^64\. AllowCountry
SetEnvIf Remote_Addr ^65\. AllowCountry
SetEnvIf Remote_Addr ^66\. AllowCountry
SetEnvIf Remote_Addr ^67\. AllowCountry
SetEnvIf Remote_Addr ^68\. AllowCountry
SetEnvIf Remote_Addr ^69\. AllowCountry
SetEnvIf Remote_Addr ^70\. AllowCountry
SetEnvIf Remote_Addr ^71\. AllowCountry
SetEnvIf Remote_Addr ^72\. AllowCountry
SetEnvIf Remote_Addr ^73\. AllowCountry
SetEnvIf Remote_Addr ^74\. AllowCountry
SetEnvIf Remote_Addr ^75\. AllowCountry
SetEnvIf Remote_Addr ^76\. AllowCountry
SetEnvIf Remote_Addr ^96\. AllowCountry
SetEnvIf Remote_Addr ^97\. AllowCountry
SetEnvIf Remote_Addr ^98\. AllowCountry
SetEnvIf Remote_Addr ^99\. AllowCountry
SetEnvIf Remote_Addr ^100\. AllowCountry
SetEnvIf Remote_Addr ^104\. AllowCountry
SetEnvIf Remote_Addr ^107\. AllowCountry
SetEnvIf Remote_Addr ^108\. AllowCountry

# ========================================
# REGLAS DE FILTRADO
# ========================================

# Denegar específicamente países bloqueados
<RequireAll>
    Require all granted
    Require not env BlockedCountry
</RequireAll>

# Orden alternativo usando Allow/Deny (comentado)
# Order Allow,Deny
# Allow from env=AllowLocal
# Allow from env=AllowPrivate  
# Allow from env=AllowCountry
# Deny from env=BlockedCountry
# Allow from all

# ========================================
# MENSAJES DE ERROR PERSONALIZADOS
# ========================================
ErrorDocument 403 "Acceso denegado: Su ubicación geográfica no está permitida por regulaciones internacionales."